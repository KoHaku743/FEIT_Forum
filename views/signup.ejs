<%- include('partials/header') %>
    <div style="background:#f6f8fa;min-height:100vh;padding-top:3em;padding-bottom:3em;">
        <div class="container" style="max-width:450px;margin:0 auto;">
            <div class="box" style="padding:2.5em 2.5em 2em 2.5em;border-radius:18px;box-shadow:0 2px 16px 0 #0001;">
                <div style="text-align:center;margin-bottom:1.5em;">
                    <span style="font-size:2.2em;color:#0079d3;">
                        <i class="fas fa-user-plus"></i>
                    </span>
                    <h2 class="title is-4" style="color:#0079d3;margin:0.5em 0 0 0;font-weight:700;">Sign Up</h2>
                </div>
                <% if (typeof error !=='undefined' && error) { %>
                    <div class="notification is-danger" style="margin-bottom:1em;">
                        <%= error %>
                    </div>
                    <% } %>
                        <form action="/signup" method="POST">
                            <div class="field">
                                <label class="label">Username</label>
                                <div class="control has-icons-left">
                                    <input class="input" type="text" name="username" placeholder="Choose a username"
                                        required autofocus>
                                    <span class="icon is-small is-left">
                                        <i class="fas fa-user"></i>
                                    </span>
                                </div>
                            </div>
                            <div class="field">
                                <label class="label">Password</label>
                                <div class="control has-icons-left">
                                    <input class="input" type="password" name="password" placeholder="Create a password"
                                        required>
                                    <span class="icon is-small is-left">
                                        <i class="fas fa-lock"></i>
                                    </span>
                                </div>
                            </div>
                            <div class="field">
                                <label class="label">Confirm Password</label>
                                <div class="control has-icons-left">
                                    <input class="input" type="password" name="confirm_password"
                                        placeholder="Repeat your password" required>
                                    <span class="icon is-small is-left">
                                        <i class="fas fa-lock"></i>
                                    </span>
                                </div>
                            </div>
                            <div class="field">
                                <label class="label">Fakulta <span
                                        style="color:#aaa;font-size:0.9em;">(optional)</span></label>
                                <div class="control">
                                    <input class="input" type="text" name="fakulta"
                                        placeholder="Your faculty (optional)">
                                </div>
                            </div>
                            <div class="field">
                                <label class="label">Group <span
                                        style="color:#aaa;font-size:0.9em;">(optional)</span></label>
                                <div class="control">
                                    <input class="input" type="text" name="user_group"
                                        placeholder="Your group (optional)">
                                </div>
                            </div>
                            <div class="field">
                                <label class="label">Choose an avatar</label>
                                <div id="avatar-picker" style="display:flex;flex-wrap:wrap;gap:1em;margin-bottom:1em;">
                                    <% const avatarFiles=[ 'default-avatar.png' , 'airplane.png' , 'astronaut.png'
                                        , 'ball.png' , 'beach.png' , 'car.png' , 'cat.png' , 'chess.png' , 'dog.png'
                                        , 'drip.png' , 'duck.png' , 'fish.png' , 'guest.png' , 'guitar.png' , 'kick.png'
                                        , 'lift-off.png' , 'red flower.png' , 'snowflake.png' ]; %>
                                        <% avatarFiles.forEach(function(file) { %>
                                            <div class="avatar-option" data-avatar="<%= file %>"
                                                style="border:2px solid #eee;border-radius:50%;padding:4px;cursor:pointer;transition:border 0.2s;">
                                                <img src="/avatars/<%= file %>" alt="avatar"
                                                    style="width:48px;height:48px;border-radius:50%;object-fit:cover;">
                                            </div>
                                            <% }); %>
                                </div>
                                <input type="hidden" name="avatar" id="avatar-input" value="default-avatar.png">
                            </div>
                            <div class="field">
                                <div style="text-align:center;"> <button class="button is-primary" type="submit"
                                        style="width:100%;">Sign Up</button>
                                </div>
                            </div>
                        </form>
                        <div style="text-align:center;margin-top:1em;">
                            <span style="color:#888;">Already have an account?</span>
                            <a href="/login"
                                style="color:#0079d3;font-weight:bold;margin-left:0.5em;transition:color 0.2s;"
                                onmouseover="this.style.color='#005fa3'" onmouseout="this.style.color='#0079d3'">Log
                                in</a>
                        </div>
            </div>
        </div>
    </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const picker = document.getElementById('avatar-picker');
            const input = document.getElementById('avatar-input');
            if (picker && input) {
                picker.querySelectorAll('.avatar-option').forEach(opt => {
                    opt.addEventListener('click', function () {
                        picker.querySelectorAll('.avatar-option').forEach(o => o.style.border = '2px solid #eee');
                        this.style.border = '2px solid #0079d3';
                        input.value = this.dataset.avatar;
                    });
                });
                // Highlight default
                picker.querySelector('.avatar-option[data-avatar="default-avatar.png"]').style.border = '2px solid #0079d3';
            }
        });
    </script>